# Parent Process PID Spoofing for Detection Evasion

The module generates an exe file with payload that automatically migrates to the IE process after execution and spoofs its parent process (PPID) as explorer.exe (Windows Explorer).

# Operation Method

+ Open the module, select a listener, and run
+ Generate and download the CPP source code

![](img/Execution_UserExecution_FakePPID/1.webp)

+ Download the source code and compile it using Visual Studio

> Viper's built-in compiler is Mingw64, which has poor anti-detection results when compiling this module. Therefore, the source code is provided for users to compile themselves.
>

![](img/Execution_UserExecution_FakePPID/2.webp)

![](img/Execution_UserExecution_FakePPID/3.webp)

![](img/Execution_UserExecution_FakePPID/4.webp)

+ Upload and run on the target machine


+ Effect when running the module-generated exe through webshell:

![](img/Execution_UserExecution_FakePPID/5.webp)

![](img/Execution_UserExecution_FakePPID/6.webp)

![](img/Execution_UserExecution_FakePPID/7.webp)

As shown, the payload process is IE with iexplore.exe as the parent process. This provides limited protection against AV detection and blue team tracing.

+ Comparison test: Effect when running exe generated by other anti-detection modules through webshell:

![](img/Execution_UserExecution_FakePPID/8.webp)![](img/Execution_UserExecution_FakePPID/9.webp)

As shown, the payload's parent process is cmd.exe (Behinder)